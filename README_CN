# PentestAndroidVM V0.1

这是一个非常早期的封闭虚拟机构建，可以用于测试应用程序的漏洞，通过预安装的APK文件进行静态和非静态测试分析。

* 在MEmu中打开OVA文件并加载要测试的APK文件。
* 这样可以避免重新构建的需要，加快测试速度，减少重新构建Android环境所需的时间。
* https://github.com/connorrutt/PentestAndroidVM

## 关于项目

* 这是一个运行Android 7.1.2的非常早期版本的已root虚拟机。随着项目的发展，我将转向支持诸如三星KNOX之类的较新的Android操作系统，该操作系统充当TPM。
* 此虚拟机是基于预安装的应用程序构建的。随着后续操作系统的发布，出现了不同的工具来避免Root检测。

# 当前工具列表。所有工具在当前版本的虚拟机和内核上都是有效且可工作的。这些可能会有所变化。

```
终端模拟器
Magisk
SManager
ES文件浏览器
Frida服务器
Sudo Hide
Zuper
Drozer
Dot Mod
SSLUnpinning
TrustMe Already
RootClock
GG Tools 2020
HidenCore模块
Hide Apps Xposed
Hide My Applist
Jasi Patcher
Lucky Patcher
FakeGapps
DIWA
ADBlocker Reborn
```

## 拥有预先Root的一次性虚拟机的重要性

Root权限授予访问通常是受限制的系统文件，允许分析和操作与应用程序相关的文件，例如配置、数据库和日志文件。此外，可以使用数据包嗅探软件拦截和修改网络流量，使用Frida和Xposed等调试工具动态分析应用程序，并完全访问设备的文件系统。这提供了识别安全漏洞和修改运行时行为的机会。自定义固件安装还可以提供其他功能，例如禁用安全功能或以调试模式运行应用程序。我们需要假设APK在最易受攻击的设备上也是安全的。

该项目正在进行测试，并且还需要进行不同的构建。目前，可以通过以下方式设置：

## 入门指南

安装包含在.zip文件中的文件。其中应该包含MEmu的安装程序和预构建的虚拟机。这是在我个人机器上测试过的开源软件。

```
安装提供的MEmu
将REDBOX.OVA保存到您的驱动器上。
在MEmu中打开多实例管理器。通过单个选项导入和升级.ova文件。
```

![image](https://github.com/connorrutt/Pent

estAndroidVM/assets/117954511/33d094ca-7377-452f-9b00-eb0f56643ffd)

## 密码：1234

* 导入后，我们需要通过提供的MEmu工具对设备进行Root操作。
* 在右侧选择设置选项，点击"Root Mode On"
* 不需要更改其他设置，因为它预先设置为使用8.8.8.8 DNS。
![image](https://github.com/connorrutt/PentestAndroidVM/assets/117954511/79e4b5bc-acc9-45bd-a6ec-23f5f32f4257)

* 在Root操作完成后重启设备。
* 重启后，打开Busy Box工具自动安装上面提到的文件。
![image](https://github.com/connorrutt/PentestAndroidVM/assets/117954511/2ada0430-1801-48d4-9c1d-eaed203cc469)

* 在重启后，在终端编辑器中使用以下命令安装Magisk：

```
su
cp -r /storage/emulated/0/init.d/run.sh /sdcard/Download/
cp -r /storage/emulated/0/init.d/magisk.apk /sdcard/Download/
sh /sdcard/Download/run.s
```
* 使用提供的文件浏览器找到APK并安装magisk.apk。
* ![image](https://github.com/connorrutt/PentestAndroidVM/assets/117954511/7a3ad87d-a858-449c-b36b-0ea282b2456f)

* 重启设备后，打开Xposed框架并选择"Install > Install"，如下所示。
![image](https://github.com/connorrutt/PentestAndroidVM/assets/117954511/79638a8c-c255-4f39-88ce-3f4575e7ef06)

* 现在虚拟机应该已经准备好并且已经获得了Root权限。使用Root Check应用程序进行检查，并在MEmu中关闭"Root"选项并重启。
![image](https://github.com/connorrutt/PentestAndroidVM/assets/117954511/1d44221e-0a4e-4844-9424-f1347659c4b5)

* 虚拟机正在运行时，我们现在需要通过主机操作系统连接到设备。
* 在PowerShell中运行以下命令：
```
cd "c:\Program Files\Microvirt\MEmu\"
adb connect 127.0.0.1:21513
```
* 要验证MEmu设备是否连接：
```
adb devices
进入手机或模拟器
adb shell 
```

查看系统安装包：
```
adb shell pm list package -s
```

查看第三方包：
```
adb shell pm list package -3
```

安装Android应用程序：
```
adb install c:\app.apk
```

重复（覆盖）安装：
```
adb install -r d:\app.apk
```

卸载Android应用程序：
```
adb uninstall org.cnodejs.android
adb uninstall <package name>
```

清除应用
